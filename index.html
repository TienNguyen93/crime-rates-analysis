<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="app.css">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#icon').click(function () {
                $('ul').toggleClass('show');
            });
        });
    </script>
    <title>Correlation between Crime Rates and Bail Reform in NYC (2018-2020)</title>
</head>
<body>
<nav>
    <ul>
        <li><a class="active" href="#">Home</a></li>
        <li><a href="mailto:&lt;tien.nguyen47@myhunter.cuny.edu&gt;">Contact</a></li>
        <li><a href="https://github.com/TienNguyen93/final-project-395.git">
            <span class="fa fa-github fa-lg" style="font-size: 25px"></span>
        </a></li>
        <li><a href="https://linkedin.com/in/tien-nguyen-a27927175">
            <span class="fa fa fa-linkedin fa-lg" style="font-size: 25px"></span>
        </a></li>
    </ul>
    <label id="icon">
        <i class="fa fa-bars"></i>
    </label>
</nav>
<div class="container-fluid">
    <div class="item" >
        <h1 class="title" style="font-weight: bold">Correlation between Crime Rates and Bail Reform in NYC (2018-2020)</h1>
        <h3 class="author">Tien Nguyen</h3>
        <br/>
        <img src="docs/assets/Images/crime.jpg">
        <p><br></p>
        <div id="toc_container">
            <p class="toc_title">Contents</p>
            <ul class="toc_list">
                <li><a href="#overview">Overview</a></li>
                <li><a href="#motivation">Motivation</a></li>
                <li><a href="#data">Data</a></li>
                <li><a href="#technique">Techniques</a></li>
                <li><a href="#main_find">Main findings</a></li>
                <li><a href="#citation">Citation</a></li>
            </ul>
        </div>

        <h2 id="overview" style="font-weight: bold">
            Overview
        </h2>
        <p><strong>Hypothesis</strong>: Does the 1st Bail Reform increase the crime rate?</p>
        <p><strong>First Bail Reform Key Takeaways:</strong>:
        <div style="font-size: 15px">
            <li>Eliminate many bail & pretrial detention for nearly all misdemeanors and non-violent crimes</li>
            <li>Aims to reduce jail population</li>
        </div>

        </p>
        <p><strong>Data</strong>:
            <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u">NYPD Arrests Data (Historic),</a>
            <a href="https://data.cityofnewyork.us/City-Government/2020-population/t8c6-3i7b">2020 population,</a>
            <a href="https://www1.nyc.gov/site/planning/planning-level/nyc-population/current-future-populations.page">
            Current Estimates of New York City's Population for July 2018,</a>
            <a href="https://oag.ca.gov/sites/all/files/agweb/pdfs/cjsc/prof10/formulas.pdf">Crime Rate Formula,</a>
            <a href="https://www.courtinnovation.org/sites/default/files/media/document/2019/Bail_Reform_NY_Summary.pdf">
            New York's Bail Reform Law Summary of Major Components</a>
        </p>
        <p><strong>Methods</strong>: arithmetic calculations, dataframe manipulations </p>
        <p><strong>Tools</strong>: Pandas, Numpy, Matplotlib</p>
        <p><br></p>

        <h2 id="motivation" style="font-weight: bold">Motivation</h2>
        <p>Ever since the COVID-19 pandemic hits, there has been a dramatic increase of crimes,
            both racially and not racially motivated, in New York City.
            On top of that, the re-releasing of criminals due to NYC bail reform can be considered as a major factor of
            this
            matter.
            Hence, in order to raise the awareness of the city's bail system and the harmfulness of this re-releasing to
            the
            community,
            the minorities, and especially the elders and the women, I seek to utilize my data analysis skills to
            advocate for
            changes in the system.</p>
        <p><br></p>

        <h2 id="data" style="font-weight: bold">Data</h2>
        <p><a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Arrests-Data-Historic-/8h9b-rp9u">NYPD Arrests Data
            (Historic)</a>
            is a breakdown of every arrest effected in NYC by the NYPD going back to 2006 through the
            end of the previous calendar year. Each record represents an arrest effected in NYC by the NYPD and includes
            information about the type of crime,
            the location and time of enforcement.
        </p>
        <p>I use this data set to analyze the crime rate both in 2018-2019 and 2019-2020. It has a total of 19 columns
            but I only keep the following for my analysis: </p>
        <div style="font-size: 15px">
            <li>ARREST_KEY: Randomly generated persistent ID for each arrest</li>
            <li>ARREST_DATE: Exact date of arrest for the reported event</li>
            <li>PD_DESC: Description of internal classification corresponding with PD code</li>
            <li>OFNS_DESC: Description of internal classification corresponding with KY code</li>
            <li>LAW_CAT_CD: Level of offense: felony, misdemeanor, violation</li>
            <li>ARREST_BORO: Borough of arrest. B(Bronx), S(Staten Island), K(Brooklyn), M(Manhattan), Q(Queens)</li>
            <li>AGE_GROUP: Perpetrator's age within a category</li>
        </div>
        <br />
        <p>The dataset has 236775 rows for January 1st 2018 to March 31st 2019 filter
        and 297575 rows for April 1st 2019 to December 31st 2020 filter</p>

        <br/>

        <h2 id="technique" style="font-weight: bold">Techniques</h2>
        <div style="font-size: 15px">
            <li>Filter unnecessary columns by using pd.drop method</li>
            <li>Find the nummber of offenses for 5 boroughs by aggregating the dataframe with groupby method</li>
            <li>Make comparison bar plot & pie charts by using matplotlib</li>
        </div>
        <p><br></p>

        <h2 id="code" style="font-weight: bold">Code</h2>
        <pre>
            <code>
"""
Author: Tien Nguyen
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

"""
Datasets used:
    *NYPD Arrests Data (Historic)
"""

#--------------------------------------------------------------------------------#
"""
'ARREST_KEY', 'ARREST_DATE', 'PD_CD', 'PD_DESC', 'KY_CD', 'OFNS_DESC',
       'LAW_CODE', 'LAW_CAT_CD', 'ARREST_BORO', 'ARREST_PRECINCT',
       'JURISDICTION_CODE', 'AGE_GROUP', 'PERP_SEX', 'PERP_RACE', 'X_COORD_CD',
       'Y_COORD_CD', 'Latitude', 'Longitude', 'Lon_Lat'
"""
df2 = pd.read_csv("../dataset/NYPD_Arrests_Data__Historic_(2019-2020).csv", low_memory=False)
# print(df2[0:5])


"""
Filter out unecessary columns df2
"""
df2 = df2.drop(columns=['PD_CD','LAW_CODE','KY_CD',
                        'ARREST_PRECINCT', 'JURISDICTION_CODE',
                        'PERP_SEX', 'PERP_RACE','X_COORD_CD', 'Y_COORD_CD', 'Latitude',
                        'Longitude', 'Lon_Lat'])
# print(df2.columns)

"""
Find sum of offense of each boroughs
"""
boro = df2.groupby('ARREST_BORO')['ARREST_KEY'].count()
boro_sum = boro.sum()
# print("BORO1 sum", boro_sum)

bronx_sum = boro[0]
bk_sum = boro[1]
manh_sum = boro[2]
queens_sum = boro[3]
si_sum = boro[4]

"""
Find crime rate of each boro
A crime rate = # of reported crimes(offenses) / total population
the result is multiplied by 100,000
"""
bx_total_pop = 1446788
bk_total_pop = 2648452
manh_total_pop = 1638281
qu_total_pop = 2330295
si_total_pop = 487155

boro_off_sum = [bronx_sum, bk_sum, manh_sum, queens_sum, si_sum]
boro_pop = [bx_total_pop, bk_total_pop, manh_total_pop, qu_total_pop, si_total_pop]

rate = [(x / y) * 100000 for x, y in zip(boro_off_sum, boro_pop)]
rate = np.round(rate)

labels = ('Bronx', 'Brooklyn', 'Manhattan', 'Queens', 'Staten Island')

#--------------------------------------------------------------------------------#
df3 = pd.read_csv("../dataset/NYPD_Arrests_Data__Historic_(2018-2019).csv", low_memory=False)
# print(df2.shape)

"""
Find total crime offenses for each boroughs
"""
boro2 = df3.groupby('ARREST_BORO')['ARREST_KEY'].count()
boro2_sum = boro2.sum()
# print("BORO@ sum", boro2_sum)

bronx_sum2 = boro2[0]
bk_sum2 = boro2[1]
manh_sum2 = boro2[2]
queens_sum2 = boro2[3]
si_sum2 = boro2[4]

"""
Find crime rate of each boro
A crime rate = # of reported crimes(offenses) / total population
the result is multiplied by 100,000
"""
bx_total_pop2 = 1432132
bk_total_pop2 = 2582830
manh_total_pop2 = 1628701
qu_total_pop2 = 2278906
si_total_pop2 = 476179

boro_off_sum2 = [bronx_sum2, bk_sum2, manh_sum2, queens_sum2, si_sum2]
boro_pop2 = [bx_total_pop2, bk_total_pop2, manh_total_pop2, qu_total_pop2, si_total_pop2]

rate2 = [(x / y) * 100000 for x, y in zip(boro_off_sum2, boro_pop2)]
rate2 = np.round(rate2)
# print(rate)

x = np.arange(len(labels))  # the label locations
width = 0.35                # the width of the bars

fig, ax = plt.subplots()
rects1 = ax.bar(x - width/2, rate2, width, label='2018-2019')
rects2 = ax.bar(x + width/2, rate, width, label='2019-2020')

# Adjust axes
ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
ax.spines['left'].set_visible(False)
ax.spines['bottom'].set_color("#DDDDDD")

# Remove ticks on y-axis
ax.tick_params(bottom=False, left=False)

# Add horizontal grid
ax.set_axisbelow(True)
ax.yaxis.grid(True, color='#EEEEEE')
ax.xaxis.grid(False)

# Add annotations
for bar in ax.patches:
    ax.annotate(
        format(bar.get_height(), '.0f'),
        (bar.get_x() + bar.get_width() / 2, bar.get_height()),
        ha='center', va='center', size=9, xytext=(0,8),
        textcoords='offset points'
    )

# Add some text for labels, title and custom x-axis tick labels, etc.
ax.set_ylabel('Crime Rate')
ax.set_xlabel('Boroughs')
ax.set_title('Crime Rate per 100,000 general population [2018-2020]' ,
             pad=15, weight='bold')
ax.set_xticks(x)
ax.set_xticklabels(labels)
ax.legend()

fig.tight_layout()

# plt.savefig("comp-bar-chart.png")
# plt.show()

# ------------------------------------------------------------------- #
"""
Pie chart of offenses for each boroughs (2019-2020)
"""
# Find the nummber of offenses for 5 boroughs
df_pie = df2.groupby(['ARREST_BORO', 'LAW_CAT_CD'], as_index=False)['ARREST_KEY'].count()

bx_pie = df_pie[df_pie['ARREST_BORO'] == "B"]
bk_pie = df_pie[df_pie['ARREST_BORO'] == "K"]
mh_pie = df_pie[df_pie['ARREST_BORO'] == "M"]
qn_pie = df_pie[df_pie['ARREST_BORO'] == "Q"]
si_pie = df_pie[df_pie['ARREST_BORO'] == "S"]

labels2 = ['Felonies', 'Infractions', 'Misdemeanors', 'Violations']

bx_size = bx_pie["ARREST_KEY"]
bk_size = bk_pie["ARREST_KEY"]
mh_size = mh_pie["ARREST_KEY"]
qn_size = qn_pie["ARREST_KEY"]
si_size = si_pie["ARREST_KEY"]

textprops = {"fontsize":15} # Font size of text in pie chart
colors = ['#ffec00','#ff0000','#007ed6','#52d726']

fig = plt.figure()
ax = plt.subplot()
ax.pie(bx_size, labels=labels2, autopct='%.1f%%',
       textprops =textprops, colors=colors, explode=[0.05]*4)
ax.set_title("Bronx Rate of Offenses [2019-2020]", weight='bold', size=15)
# fig.savefig("bx-pie.png")

fig2 = plt.figure()
ax2 = plt.subplot()
ax2.pie(bk_size, labels=labels2, autopct='%.1f%%',
        textprops =textprops, colors=colors, explode=[0.05]*4)
ax2.set_title("Brooklyn Rate of Offenses [2019-2020]", weight='bold', size=15)
# fig2.savefig("bk-pie.png")

fig3 = plt.figure()
ax3 = plt.subplot()
ax3.pie(mh_size, labels=labels2, autopct='%.1f%%',
        textprops =textprops, colors=colors, explode=[0.05]*4)
ax3.set_title("Manhattan Rate of Offenses [2019-2020]", weight='bold', size=15)
# fig3.savefig("mh-pie.png")

fig4 = plt.figure()
ax4 = plt.subplot()
ax4.pie(qn_size, labels=labels2, autopct='%.1f%%',
        textprops =textprops, colors=colors, explode=[0.05]*4)
ax4.set_title("Queens Rate of Offenses [2019-2020]", weight='bold', size=15)
# fig4.savefig("qn-pie.png")

fig5 = plt.figure()
ax5 = plt.subplot()
ax5.pie(si_size, labels=labels2, autopct='%.1f%%',
        textprops =textprops, colors=colors, explode=[0.05]*4)
ax5.set_title("Staten Island Rate of Offenses [2019-2020]", weight='bold', size=15)
# fig5.savefig("si-pie.png")

# plt.show()

"""
Difference and % increase of crime rate
"""

diff = []
diff_obj = zip(boro_off_sum, boro_off_sum2)
for x, y in diff_obj:
    res = np.round(((x - y) / boro2_sum) * 100, 2)
    diff.append(res)

# print(diff)
#5.91, 6.55, 6.18, 6.05, 0.98
            </code>
        </pre>
        <code>

        </code>

        <h2 id="main_find" style="font-weight: bold">Main findings</h2>
        <div style="font-size: 15px">
            <p style="font-size: 15px"><strong>After the first bail reform on April 1st 2019:</strong></p>

            <li>Crime rate in the Bronx increases by 5.91%</li>
            <li>Crime rate in the Brooklyn increases by 6.55% </li>
            <li>Crime rate in the Manhattan increases by 6.18%</li>
            <li>Crime rate in the Queens increases by 6.05%</li>
            <li>Crime rate in the Staten Island increases by 0.98%</li>

            <div style="text-align: center;">
                <img src="docs/assets/Images/comp-bar-chart.png" >
            </div>
            <br/>
            <ul><p style="font-size: 15px"><strong>Pie charts of crime classifications across the 5 boroughs (2019-2020) shows that:</strong></p></ul>
            <li>Brooklyn has the highest rate of the felonies classification <strong>(49.0%)</strong></li>
            <li>Bronx has the highest rate of the misdemeanors classification <strong>(59.9%)</strong></li>
        </div>
        <div class="gallery-grid">
            <figure class="gallery-frame">
                <img class="gallery-img" src="docs/assets/Images/bx-pie.png">
            </figure>
            <figure class="gallery-frame">
                <img class="gallery-img" src="docs/assets/Images/bk-pie.png">
            </figure>
            <figure class="gallery-frame">
                <img class="gallery-img" src="docs/assets/Images/mh-pie.png">
            </figure>
            <figure class="gallery-frame">
                <img class="gallery-img" src="docs/assets/Images/qn-pie.png">
            </figure>
            <figure class="gallery-frame">
                <img class="gallery-img" src="docs/assets/Images/si-pie.png">
            </figure>
        </div>
        <p><br></p>

        <h2 id="citation" style="font-weight: bold">Citation</h2>
        <p><a href="https://data.cityofnewyork.us/City-Government/2020-population/t8c6-3i7b">2020 population:</a>
            projected New York City population numbers and percentage changes from 2010 through 2040 by Borough,
            including school-age, 65 and Over, and total population.</p>

        <p><a href="https://www1.nyc.gov/site/planning/planning-level/nyc-population/current-future-populations.page">
            Current Estimates of New York City's Population for July 2018:</a>
            U.S. Census Bureau's estimation of New York City's population as of July 1, 2018.
        </p>

        <p><a href="https://oag.ca.gov/sites/all/files/agweb/pdfs/cjsc/prof10/formulas.pdf">Crime Rate Formula:</a>
        a reference sheet to perform crime rate calculation </p>

        <p><a href="https://www.courtinnovation.org/sites/default/files/media/document/2019/Bail_Reform_NY_Summary.pdf">
            New York's Bail Reform Law Summary of Major Components:</a>
            detail changes of the reform, including the elimination of Money Bail and Pretrial Detention for
            most misdeamnors and nonviolent felonies, Judges power in setting bail based on defendants financial condition,
            the releasing of defendants while their cases are pending, the Legislation allows for Conditions of
            Release other than Money Bail in certain circumstances, and potential impacts </p>
        </p>

        <p><a href="https://www.pythoncharts.com/matplotlib/beautiful-bar-charts-matplotlib/">
            Beautiful Bar Charts in Matplotlib</a></p>

        <p><a href="https://www.python-graph-gallery.com/">The Python Graph Gallery</a></p>
        <p><a href="https://www.w3schools.com/">W3Schools</a></p>
    </div>

</div>

</body>
</html>
